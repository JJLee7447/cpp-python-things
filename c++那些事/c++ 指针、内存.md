# c++指针与动态内存分配

```c++
int *p = new int {10};
delete p;
p=nullptr;
```

​		这段代码使用了动态内存分配，然后在使用完之后使用了 `delete` 运算符释放了所分配的内存空间，并将指针变量 `p` 设置为 `nullptr`。具体来说，这段代码的作用如下：

1. 分配内存空间：使用 `new` 运算符在堆上分配了一块新的内存空间，用于存储一个 `int` 类型的值，并将该内存空间的地址赋给指针变量 `p`。
2. 使用分配的内存空间：通过指针变量 `p` 访问分配的内存空间中存储的数据，这里是一个值为 `10` 的整数。
3. 释放内存空间：使用 `delete` 运算符释放之前分配的内存空间，这样可以将该内存空间返回给堆，供其他程序使用。
4. 清空指针变量：将指针变量 `p` 设置为 `nullptr`，这是一种良好的编程习惯，可以避免指针被误用。

需要注意的是，释放内存空间后，指针变量 `p` 指向的内存空间已经不再是有效的，因此在将 `p` 设置为 `nullptr` 之前，一定要先使用 `delete` 运算符释放内存空间。同时，将 `p` 设置为 `nullptr` 可以避免悬空指针的问题，即指针指向了一个已经被释放的内存空间。这是一种常见的编程错误，可能会导致程序崩溃或产生未定义的行为。

# c++ 内存分区

[参考文章1](https://blog.csdn.net/m0_65635427/article/details/127785398)

[参考文章2](https://blog.csdn.net/weixin_46098577/article/details/122174159)

C++程序中内存分为四个主要区域：**栈、堆、全局/静态存储区、代码区。**这四个区域都有各自的特点和用途。

1. **栈（Stack）区**：栈是程序自动分配和释放的一块连续内存区域，主要用于存储函数调用时的局部变量、函数参数以及返回值等。栈的内存分配和释放由系统自动管理，当函数调用结束时，函数的局部变量和参数都会自动被释放。栈内存的空间比较有限，通常只有几兆字节，不能用来存储大量的数据。
2. **堆（Heap）区**：堆是一块较大的内存区域，主要用于动态分配内存，例如使用 new 操作符动态分配内存。堆区的内存分配和释放由程序员自行管理，需要手动调用 delete 操作符进行释放，否则会出现内存泄漏问题。由于堆的内存空间比较大，通常用于存储动态分配的大量数据。
3. **全局/静态存储区（.bss 段和 .data 段）**：全局/静态存储区是用来存储全局变量和静态变量的内存区域。全局变量和静态变量的内存分配和释放在程序的整个生命周期内都有效，只有当程序结束时才会被系统自动释放。全局变量和静态变量的生命周期可以通过 static 关键字进行控制，可以实现全局变量和静态变量的局部作用域。
4. **代码区**：代码区是用来存储程序的可执行代码的内存区域。代码区通常是只读的，不允许进行写操作。程序在运行时，代码区的代码会被加载到内存中执行。

了解不同的内存分区并合理地使用内存是 C++ 编程中非常重要的一部分，可以避免出现内存泄漏、内存溢出等问题，保证程序的安全和效率。同时，需要注意动态内存的释放，避免出现悬空指针等问题。

